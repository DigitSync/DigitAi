<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DigitAi - Boss Dashboard</title>
    
    <!-- React & DOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Icons (Lucide) -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        /* WhatsApp Dark Mode Colors */
        body { background-color: #111b21; color: #e9edef; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; }
        .bg-app-bar { background-color: #202c33; }
        .bg-chat-bg { background-color: #0b141a; background-image: url('https://user-images.githubusercontent.com/15075759/28719144-86dc0f70-73b1-11e7-911d-60d70fcded21.png'); background-blend-mode: overlay; background-size: 400px; }
        .bg-incoming { background-color: #202c33; }
        .bg-outgoing { background-color: #005c4b; }
        .text-wa-green { color: #00a884; }
        .bg-wa-green { background-color: #00a884; }
        
        /* Scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #374045; border-radius: 3px; }
    </style>
</head>
<body>

<div id="root"></div>

<script type="text/babel">

    // ==========================================
    // ðŸ› ï¸ BOSS SETTINGS (CUSTOMIZE HERE) ðŸ› ï¸
    // ==========================================
    
    const BOSS_NAME = "Rouf Uddin Ahmed (Boss)";
    const COMPANY_NAME = "DigitMart Electronics";
    
    // Yahan tum characters ka behavior change kar sakte ho
    const CHARACTERS = [
        {
            id: 'orina',
            name: 'Orina (Assistant)',
            role: 'DigitMart AI',
            avatar: 'ðŸ‘©â€ðŸ’¼', // Emoji or Image URL
            color: 'text-teal-400',
            systemPrompt: `Your name is Orina. You are the AI Assistant of DigitMart Electronics in Tezpur, Assam. Your Boss is Rouf Uddin Ahmed. You are professional, smart, and helpful. You speak in Hinglish (Hindi + English). You handle shop queries, online works, mobile repairing advice, and help students with assignments. Always call the user 'Boss' or 'Sir'. Be strictly loyal to Rouf. If someone asks about the shop, say: "DigitMart deals in Mobile Repairing, Accessories, Online Works & Computer Classes at Tezpur."`
        },
        {
            id: 'kamina_dost',
            name: 'Kamina Dost (Rohan)',
            role: 'College Bestie',
            avatar: 'ðŸ˜Ž',
            color: 'text-yellow-400',
            systemPrompt: `You are Rohan, the user's best friend from college. You are a "Kamina" friend. You roast the user, make fun of him, talk about girls, bunking classes, and movies. You never talk formally. Use slang Hinglish. If the user asks for advice, give terrible/funny advice first, then maybe something useful. Address the user as 'Bhai' or 'Gaddar'.`
        },
        {
            id: 'english_mam',
            name: 'English Ma\'am',
            role: 'Strict Teacher',
            avatar: 'ðŸ‘©â€ðŸ«',
            color: 'text-purple-400',
            systemPrompt: `You are a strict English teacher. You speak formal English mixed with Hindi explanations. Correct the user's grammar in every reply. You want the user to succeed in life but you are very disciplined. Scold him if he uses slang.`
        },
        {
            id: 'maths_sir',
            name: 'Verma Sir (Maths)',
            role: 'Maths HOD',
            avatar: 'ðŸ‘¨â€ðŸ«',
            color: 'text-blue-400',
            systemPrompt: `You are Verma Sir, a Mathematics teacher. You talk in logic, numbers, and theorems. You are obsessed with calculation. Speak in Hinglish. Encourage the user to solve problems.`
        },
        {
            id: 'principal',
            name: 'College Principal',
            role: 'Head Authority',
            avatar: 'ðŸ‘´',
            color: 'text-red-500',
            systemPrompt: `You are the College Principal. You are extremely strict, authoritative, and care about the college reputation. You hate indiscipline. Speak formally.`
        }
    ];

    // ==========================================
    // âš™ï¸ APP LOGIC (DO NOT TOUCH BELOW)
    // ==========================================

    const { useState, useEffect, useRef } = React;
    const { Send, ArrowLeft, MoreVertical, Search, Camera, Phone, Video, Smile, Paperclip, Settings, ExternalLink, Key, Trash2 } = lucide;

    function App() {
        const [apiKey, setApiKey] = useState(localStorage.getItem('digitai_key') || '');
        const [view, setView] = useState(apiKey ? 'list' : 'setup'); // setup, list, chat
        const [activeChat, setActiveChat] = useState(null);
        const [messages, setMessages] = useState(() => JSON.parse(localStorage.getItem('digitai_history')) || {});
        const [input, setInput] = useState('');
        const [loading, setLoading] = useState(false);
        const scrollRef = useRef(null);

        useEffect(() => {
            localStorage.setItem('digitai_history', JSON.stringify(messages));
        }, [messages]);

        useEffect(() => {
            if (view === 'chat') scrollToBottom();
        }, [messages, view, loading]);

        useEffect(() => {
            lucide.createIcons();
        }, [view]);

        const scrollToBottom = () => scrollRef.current?.scrollIntoView({ behavior: "smooth" });

        const saveKey = () => {
            if(!apiKey.trim()) return alert("Key toh daal Boss!");
            localStorage.setItem('digitai_key', apiKey);
            setView('list');
        };

        const resetApp = () => {
            if(confirm("Sab delete karun? (Key and Chats)")) {
                localStorage.removeItem('digitai_key');
                localStorage.removeItem('digitai_history');
                location.reload();
            }
        };

        const handleSend = async () => {
            if (!input.trim()) return;
            
            const text = input;
            setInput('');
            const char = activeChat;
            
            // Add User Message
            const userMsg = { id: Date.now(), text, sender: 'user', time: new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}) };
            
            setMessages(prev => ({
                ...prev,
                [char.id]: [...(prev[char.id] || []), userMsg]
            }));

            setLoading(true);

            // API Call
            try {
                const history = (messages[char.id] || []).slice(-6).map(m => ({
                    role: m.sender === 'user' ? 'user' : 'model',
                    parts: [{ text: m.text }]
                }));

                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        contents: [...history, { role: "user", parts: [{ text }] }],
                        systemInstruction: { parts: [{ text: char.systemPrompt }] }
                    })
                });

                const data = await response.json();
                const aiText = data.candidates?.[0]?.content?.parts?.[0]?.text || "Server busy hai Boss, check net connection.";

                const aiMsg = { id: Date.now()+1, text: aiText, sender: 'ai', time: new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}) };
                
                setMessages(prev => ({
                    ...prev,
                    [char.id]: [...(prev[char.id] || []), aiMsg]
                }));

            } catch (error) {
                alert("API Error: Key check karo ya net on karo.");
            }

            setLoading(false);
        };

        // --- RENDER: SETUP ---
        if (view === 'setup') {
            return (
                <div className="h-screen flex flex-col items-center justify-center p-6 bg-[#111b21] text-center">
                    <div className="w-24 h-24 bg-wa-green rounded-full flex items-center justify-center mb-6 shadow-lg animate-pulse">
                        <span className="text-4xl">ðŸ¤–</span>
                    </div>
                    <h1 className="text-2xl font-bold text-white mb-2">Welcome to DigitAi</h1>
                    <p className="text-gray-400 text-sm mb-8">Personal AI Ecosystem for DigitMart</p>
                    
                    <div className="bg-app-bar p-6 rounded-xl w-full max-w-md border border-gray-700">
                        <p className="text-green-400 text-xs font-bold uppercase mb-2 text-left">Step 1: Get Key</p>
                        <a href="https://aistudio.google.com/app/apikey" target="_blank" className="flex items-center justify-center gap-2 bg-gray-700 p-3 rounded-lg text-white mb-6 text-sm hover:bg-gray-600 transition">
                            <i data-lucide="external-link"></i> Google se Key lao (Free)
                        </a>

                        <p className="text-green-400 text-xs font-bold uppercase mb-2 text-left">Step 2: Paste Key</p>
                        <input 
                            type="password" 
                            placeholder="Paste Gemini Key here..." 
                            className="w-full bg-[#2a3942] text-white p-3 rounded-lg mb-4 outline-none focus:border-green-500 border border-transparent"
                            value={apiKey}
                            onChange={e => setApiKey(e.target.value)}
                        />
                        <button onClick={saveKey} className="w-full bg-wa-green hover:opacity-90 text-white font-bold p-3 rounded-lg">
                            Start System
                        </button>
                    </div>
                </div>
            );
        }

        // --- RENDER: LIST ---
        if (view === 'list') {
            return (
                <div className="h-screen flex flex-col bg-[#111b21]">
                    {/* Header */}
                    <div className="bg-app-bar p-4 flex justify-between items-center text-gray-300">
                        <h1 className="text-xl font-bold text-white">DigitAi</h1>
                        <div className="flex gap-5">
                            <i data-lucide="camera" className="w-6 h-6"></i>
                            <i data-lucide="search" className="w-6 h-6"></i>
                            <i data-lucide="settings" className="w-6 h-6 cursor-pointer hover:text-white" onClick={resetApp}></i>
                        </div>
                    </div>
                    
                    {/* Tabs */}
                    <div className="bg-app-bar flex text-gray-400 font-medium text-sm">
                        <div className="w-12 py-2 flex justify-center"><i data-lucide="users" className="w-5 h-5"></i></div>
                        <div className="flex-1 text-center py-2 text-wa-green border-b-2 border-[#00a884]">Chats</div>
                        <div className="flex-1 text-center py-2">Status</div>
                        <div className="flex-1 text-center py-2">Calls</div>
                    </div>

                    {/* Chat List */}
                    <div className="flex-1 overflow-y-auto">
                        {CHARACTERS.map(char => {
                            const lastMsg = messages[char.id]?.slice(-1)[0];
                            return (
                                <div key={char.id} onClick={() => {setActiveChat(char); setView('chat')}} className="flex items-center gap-3 p-3 hover:bg-[#202c33] cursor-pointer transition">
                                    <div className="w-12 h-12 rounded-full bg-gray-700 flex items-center justify-center text-2xl relative overflow-hidden">
                                        {char.avatar}
                                    </div>
                                    <div className="flex-1 border-b border-gray-800 pb-3">
                                        <div className="flex justify-between mb-1">
                                            <h3 className="text-white font-medium text-lg">{char.name}</h3>
                                            <span className="text-xs text-gray-500">{lastMsg ? lastMsg.time : 'New'}</span>
                                        </div>
                                        <p className="text-sm text-gray-400 truncate w-64">
                                            {lastMsg ? (lastMsg.sender === 'user' ? `You: ${lastMsg.text}` : lastMsg.text) : 'Tap to start conversation...'}
                                        </p>
                                    </div>
                                </div>
                            )
                        })}
                        <div className="mt-8 text-center">
                            <p className="text-[10px] text-gray-600 flex items-center justify-center gap-1">
                                <i data-lucide="lock" className="w-3 h-3"></i> End-to-end encrypted (Locally)
                            </p>
                        </div>
                    </div>
                </div>
            );
        }

        // --- RENDER: CHAT ---
        if (view === 'chat' && activeChat) {
            return (
                <div className="h-screen flex flex-col bg-chat-bg">
                    {/* Chat Header */}
                    <div className="bg-app-bar p-2 flex items-center gap-2 text-white">
                        <button onClick={() => setView('list')} className="p-1 rounded-full hover:bg-gray-700">
                            <i data-lucide="arrow-left" className="w-6 h-6"></i>
                        </button>
                        <div className="w-10 h-10 rounded-full bg-gray-700 flex items-center justify-center text-xl">
                            {activeChat.avatar}
                        </div>
                        <div className="flex-1 cursor-pointer">
                            <h2 className="font-medium">{activeChat.name}</h2>
                            <p className="text-xs text-gray-400">Online</p>
                        </div>
                        <div className="flex gap-4 pr-2 text-white">
                            <i data-lucide="video" className="w-6 h-6"></i>
                            <i data-lucide="phone" className="w-6 h-6"></i>
                            <i data-lucide="more-vertical" className="w-6 h-6"></i>
                        </div>
                    </div>

                    {/* Messages */}
                    <div className="flex-1 overflow-y-auto p-4 space-y-2">
                        <div className="bg-[#1f2c34] text-[#ffd279] text-xs p-2 rounded-lg text-center shadow mb-4 max-w-sm mx-auto">
                            Messages are generated by AI. Boss rules apply.
                        </div>

                        {(messages[activeChat.id] || []).map(msg => (
                            <div key={msg.id} className={`flex ${msg.sender === 'user' ? 'justify-end' : 'justify-start'}`}>
                                <div className={`max-w-[80%] rounded-lg px-2 py-1 shadow text-sm relative ${msg.sender === 'user' ? 'bg-outgoing text-white rounded-tr-none' : 'bg-incoming text-white rounded-tl-none'}`}>
                                    <span className="whitespace-pre-wrap leading-relaxed block pr-16 pb-2">{msg.text}</span>
                                    <span className="text-[10px] text-gray-400 absolute bottom-1 right-2 flex items-center gap-1">
                                        {msg.time} {msg.sender === 'user' && 'âœ“âœ“'}
                                    </span>
                                </div>
                            </div>
                        ))}
                        
                        {loading && (
                            <div className="flex justify-start">
                                <div className="bg-incoming p-3 rounded-lg rounded-tl-none">
                                    <div className="flex gap-1">
                                        <div className="w-1.5 h-1.5 bg-gray-400 rounded-full animate-bounce"></div>
                                        <div className="w-1.5 h-1.5 bg-gray-400 rounded-full animate-bounce delay-100"></div>
                                        <div className="w-1.5 h-1.5 bg-gray-400 rounded-full animate-bounce delay-200"></div>
                                    </div>
                                </div>
                            </div>
                        )}
                        <div ref={scrollRef}></div>
                    </div>

                    {/* Input */}
                    <div className="bg-app-bar p-2 flex items-center gap-2">
                        <div className="bg-[#2a3942] p-2 rounded-full text-gray-400">
                             <i data-lucide="smile" className="w-6 h-6"></i>
                        </div>
                        <div className="flex-1 bg-[#2a3942] rounded-lg flex items-center px-4 py-2">
                            <input 
                                type="text" 
                                className="w-full bg-transparent text-white outline-none placeholder-gray-500" 
                                placeholder="Message"
                                value={input}
                                onChange={e => setInput(e.target.value)}
                                onKeyDown={e => e.key === 'Enter' && handleSend()}
                            />
                        </div>
                        <button onClick={handleSend} disabled={loading || !input.trim()} className="bg-wa-green p-3 rounded-full text-white shadow hover:opacity-90 transition transform active:scale-95">
                            <i data-lucide="send" className="w-5 h-5"></i>
                        </button>
                    </div>
                </div>
            );
        }

        return <div>Error loading view</div>;
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
</script>

</body>
</html>

